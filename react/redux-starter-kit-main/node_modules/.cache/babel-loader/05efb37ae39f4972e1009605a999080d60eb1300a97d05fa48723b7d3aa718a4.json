{"ast":null,"code":"\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nexports.__esModule = true;\nexports.sortResults = void 0;\nvar debug_1 = require(\"debug\");\nvar get_1 = __importDefault(require(\"lodash/get\"));\nvar log = debug_1.debug('sortResults');\nfunction warnOnIneffectiveSortingKeys(sortCriteria) {\n  var _a = __read(Object.keys(sortCriteria)),\n    mainCriteria = _a[0],\n    siblings = _a.slice(1);\n  if (siblings.length > 0) {\n    console.warn('Sorting by \"%s\" has no effect: already sorted by \"%s\".', siblings.join(','), mainCriteria);\n  }\n}\nfunction flattenSortCriteria(orderBy, propertyPath) {\n  if (propertyPath === void 0) {\n    propertyPath = [];\n  }\n  log('flattenSortCriteria:', orderBy, propertyPath);\n  return orderBy.reduce(function (criteria, properties) {\n    warnOnIneffectiveSortingKeys(properties);\n    // Multiple properties in a single criteria object are forbidden.\n    // Use the list of criteria objects for multi-criteria sort.\n    var property = Object.keys(properties)[0];\n    var sortDirection = properties[property];\n    var path = propertyPath.concat(property.toString());\n    log({\n      property: property,\n      sortDirection: sortDirection,\n      path: path\n    });\n    // Recursively flatten order criteria when referencing\n    // relational properties.\n    var newCriteria = typeof sortDirection === 'object' ? flattenSortCriteria([sortDirection], path) : [[path, sortDirection]];\n    log('pushing new criteria:', newCriteria);\n    return criteria.concat(newCriteria);\n  }, []);\n}\n/**\n * Sorts the given list of entities by a certain criteria.\n */\nfunction sortResults(orderBy, data) {\n  log('sorting data:', data);\n  log('order by:', orderBy);\n  var criteriaList = [].concat(orderBy);\n  log('criteria list:', criteriaList);\n  var criteria = flattenSortCriteria(criteriaList);\n  log('flattened criteria:', JSON.stringify(criteria));\n  data.sort(function (left, right) {\n    var e_1, _a;\n    try {\n      for (var criteria_1 = __values(criteria), criteria_1_1 = criteria_1.next(); !criteria_1_1.done; criteria_1_1 = criteria_1.next()) {\n        var _b = __read(criteria_1_1.value, 2),\n          path = _b[0],\n          sortDirection = _b[1];\n        var leftValue = get_1[\"default\"](left, path);\n        var rightValue = get_1[\"default\"](right, path);\n        log('comparing value at \"%s\" (%s): \"%s\" / \"%s\"', path, sortDirection, leftValue, rightValue);\n        if (leftValue > rightValue) {\n          return sortDirection === 'asc' ? 1 : -1;\n        }\n        if (leftValue < rightValue) {\n          return sortDirection === 'asc' ? -1 : 1;\n        }\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (criteria_1_1 && !criteria_1_1.done && (_a = criteria_1[\"return\"])) _a.call(criteria_1);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n    return 0;\n  });\n  log('sorted results:\\n', data);\n}\nexports.sortResults = sortResults;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}